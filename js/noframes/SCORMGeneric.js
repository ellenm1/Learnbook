var g_bShowApiErrors=true;var g_strAPINotFound="Management system interface not found.";var g_strAPITooDeep="Cannot find API - too deeply nested.";var g_strAPIInitFailed="Found API but LMSInitialize failed.";var g_strAPISetError="Trying to set value but API not available.";var g_nSCO_ScoreMin=0;var g_nSCO_ScoreMax=100;var g_SCO_MasteryScore=99.9;var g_bMasteryScoreInitialized=false;var g_nFindAPITries=0;var g_objAPI=null;var g_bInitDone=false;var g_bFinishDone=false;var g_bIsSuspended=false;var g_bSCOBrowse=false;var g_dtmInitialized=new Date();var g_gbGoingToNextSco=false;function completeIfLastPage(){if(!APIOK()){return false}else{if(g_bFinishDone==false){if(znThisPage==ls.length){SCOFinish()}else{}}else{if((SCOGetValue("cmi.core.lesson_mode")=="Completed")||(SCOGetValue("cmi.core.lesson_mode")=="Passed")){SCOFinish()}}}}function AlertUserOfAPIError(a){if((g_bShowApiErrors)){SetCookie("referenceMode",false,1);if(ReadCookie("referenceMode")==false){alert('You will not receive credit because you arrived here without enrolling. If you want credit, return to MLearning and enroll in this course. "');SetCookie("referenceMode",true,1)}window.status="It appears you did not launch this from MLearning. No score will be recorded"}}function FindAPI(a){while((a.API==null)&&(a.parent!=null)&&(a.parent!=a)){g_nFindAPITries++;if(g_nFindAPITries>500){AlertUserOfAPIError(g_strAPITooDeep);return null}a=a.parent}return a.API}function APIOK(){return((typeof(g_objAPI)!="undefined")&&(g_objAPI!=null))}function SCOInitialize(){var a=true;if(!g_bInitDone){console.log("QWE in SCOInitialize and g_bInitDone is false");if((window.parent)&&(window.parent!=window)){g_objAPI=FindAPI(window.parent)}if((g_objAPI==null)&&(window.opener!=null)){g_objAPI=FindAPI(window.opener)}if(!APIOK()){AlertUserOfAPIError(g_strAPINotFound);a=false}else{a=g_objAPI.LMSInitialize("");if(a=="true"){g_bSCOBrowse=(g_objAPI.LMSGetValue("cmi.core.lesson_mode")=="browse");if(!g_bSCOBrowse){if(g_objAPI.LMSGetValue("cmi.core.lesson_status")=="not attempted"){a=g_objAPI.LMSSetValue("cmi.core.lesson_status","incomplete")}}}else{AlertUserOfAPIError(g_strAPIInitFailed)}}}if(typeof(SCOInitData)!="undefined"){SCOInitData()}g_bInitDone=true;g_dtmInitialized=new Date();return(a+"")}function SCOSaveData(){if(APIOK()){SCOCommit();if((quizCount==0)&&(!g_bIsSuspended)){SCOSetStatusCompleted()}else{if(quizCount>0){SCOSetValue("cmi.core.exit","")}}}}function SCOSuspend(){if(APIOK()&&(g_bFinishDone==false)){SCOCommit();SCOSetValue("cmi.core.exit","suspend");g_bIsSuspended=true;SCOFinish()}}function SCOFinish(){if((APIOK())&&(g_bFinishDone==false)){if(typeof(SCOSaveData)!="undefined"){SCOReportSessionTime();SCOSaveData()}SetCookie(g_bInitDone,"",-1);g_bFinishDone=(g_objAPI.LMSFinish("")=="true")}return(g_bFinishDone+"")}function SCOGetValue(a){return((APIOK())?g_objAPI.LMSGetValue(a.toString()):"")}function SCOCommit(a){return((APIOK())?g_objAPI.LMSCommit(""):"false")}function SCOGetLastError(a){return((APIOK())?g_objAPI.LMSGetLastError(""):"-1")}function SCOGetErrorString(a){return((APIOK())?g_objAPI.LMSGetErrorString(a):"No API")}function SCOGetDiagnostic(a){return((APIOK())?g_objAPI.LMSGetDiagnostic(a):"No API")}var g_bMinScoreAcquired=false;var g_bMaxScoreAcquired=false;function SCOSetValue(b,c){var a="";if(!APIOK()){AlertUserOfAPIError(g_strAPISetError+"\n"+b+"\n"+c);a="false"}else{if(b=="cmi.core.score.raw"){a=privReportRawScore(c)}}if(a==""){a=g_objAPI.LMSSetValue(b,c.toString()+"");if(a!="true"){return a}}if(b=="cmi.core.score.min"){g_bMinScoreAcquired=true;g_nSCO_ScoreMin=c}else{if(b=="cmi.core.score.max"){g_bMaxScoreAcquired=true;g_nSCO_ScoreMax=c}}return a}function privReportRawScore(c){if(isNaN(c)){return"false"}if(!g_bMinScoreAcquired){if(g_objAPI.LMSSetValue("cmi.core.score.min",g_nSCO_ScoreMin+"")!="true"){return"false"}}if(!g_bMaxScoreAcquired){if(g_objAPI.LMSSetValue("cmi.core.score.max",g_nSCO_ScoreMax+"")!="true"){return"false"}}if(g_objAPI.LMSSetValue("cmi.core.score.raw",c)!="true"){return"false"}g_bMinScoreAcquired=false;g_bMaxScoreAcquired=false;if(!g_bMasteryScoreInitialized){var a=parseInt(SCOGetValue("cmi.student_data.mastery_score"),10);if(!isNaN(a)){g_SCO_MasteryScore=a}}if(isNaN(g_SCO_MasteryScore)){return"false"}var b=(c>=g_SCO_MasteryScore?"passed":"failed");if(SCOSetValue("cmi.core.lesson_status",b)!="true"){return"false"}return"true"}function MillisecondsToCMIDuration(g){var e="";var f=new Date();f.setTime(g);var d="000"+Math.floor(g/3600000);var a="0"+f.getMinutes();var c="0"+f.getSeconds();var b="0"+Math.round(f.getMilliseconds()/10);e=d.substr(d.length-4)+":"+a.substr(a.length-2)+":";e+=c.substr(c.length-2)+"."+b.substr(b.length-2);return e}function SCOReportSessionTime(){var a=new Date();var b=a.getTime()-g_dtmInitialized.getTime();return SCOSetValue("cmi.core.session_time",MillisecondsToCMIDuration(b))}function SCOSetStatusIncomplete(){if((SCOGetValue("cmi.core.lesson_status")!="completed")||(SCOGetValue("cmi.core.lesson_status")!="passed")){SCOSetValue("cmi.core.lesson_status","incomplete");
SCOCommit()}}function SCOSetStatusCompleted(){var a=SCOGetValue("cmi.core.lesson_status");if((SCOGetValue("cmi.core.lesson_mode")!="browse")&&(!g_bIsSuspended)){if((a!="completed")&&(a!="passed")&&(a!="failed")){return SCOSetValue("cmi.core.lesson_status","completed")}}else{}}function SCOSetStatus(){if(APIOK()){if((typeof iMasteryScore!="undefined")&&(!isNaN(iMasteryScore))&&(iMasteryScore>0)){isScoredModule=true;if(testing){console.log("B33 isScoreModule = "+isScoredModule)}if((typeof lmsScore!="undefined")&&(!isNaN(lmsScore))&&(lmsScore>0)){moduleScore=lmsScore;console.log("lmsScore="+lmsScore)}else{moduleScore=0}}if((lmsStatus=="completed")&&(typeof qsParm.ls=="undefined")){SCOSetValue("cmi.core.lesson_status","incomplete")}if((lmsStatus=="passed")&&(typeof qsParm.ls=="undefined")){SCOSetValue("cmi.core.lesson_status","incomplete");moduleScore=lmsScore}else{if(isScoredModule){if(lmsStatus!="passed"){SCOSetValue("cmi.core.score.raw",moduleScore);SCOSetValue("cmi.core.lesson_status","incomplete");SCOCommit}else{SCOSetValue("cmi.core.lesson_status","incomplete");SCOCommit}}}}}function SCOUnload(){if(APIOK()&&(!g_bFinishDone)&&(!g_bIsSuspended)){if(isScoredModule){if(testing){console.log("ACE g_bFinishDone= "+g_bFinishDone+", g_bIsSuspended= "+g_bIsSuspended)}SCOCommit();SCOSetValue("cmi.core.lesson_status","incomplete");SCOSetValue("cmi.core.exit","suspend");g_bIsSuspended=true;SCOFinish()}else{if((!g_bFinishDone)&&(!g_bIsSuspended)&&(!g_gbGoingToNextSco)){if(testing){console.log("ABE g_bFinishDone= "+g_bFinishDone+", g_bIsSuspended= "+g_bIsSuspended+", g_gbGoingToNextSco="+g_gbGoingToNextSco)}var a=confirm('If you want to mark this module complete, please click "OK" Otherwise, click "Cancel" and I will save your progress for later');if(a==true){SCOSetValue("cmi.core.lesson_status","completed");SCOSetValue("cmi.core.exit","");SCOFinish()}else{SCOSetValue("cmi.core.lesson_status","incomplete");SCOSetValue("cmi.core.exit","suspend");g_bIsSuspended=true;SCOFinish()}}}}}function SCOBookmark(){pArrayItem=ps[znThisPage];var a=(typeof pArrayItem.quiz!="undefined")?true:false;if(!APIOK()){return false}if((znThisPage>1)&&(znThisPage<ps.length)&&(!a)){SCOSetValue("cmi.core.lesson_location",znThisPage);SCOCommit()}else{if(znThisPage==ps.length){}else{if(a){}}}};